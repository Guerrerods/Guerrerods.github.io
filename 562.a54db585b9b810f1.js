"use strict";(self.webpackChunkEscuelaDS=self.webpackChunkEscuelaDS||[]).push([[562],{9562:(at,Z,o)=>{o.r(Z),o.d(Z,{TalleresCapitanComponent:()=>et});var t=o(4650),d=o(6895),A=o(4514),T=o(3546),s=o(7155),C=o(8739),b=o(6308),f=o(9549),v=o(4144),S=o(7392),M=o(266),u=o(4859),c=o(5412),N=o(3162),U=o(7009),g=o(3999),p=o(4006),x=o(4385),h=o(9602),z=o(3238);function y(a,i){1&a&&(t.TgZ(0,"span"),t._uU(1,"La fecha es "),t.TgZ(2,"strong"),t._uU(3,"requerida"),t.qZA()())}function k(a,i){if(1&a&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.descripcion," ")}}function q(a,i){1&a&&(t.TgZ(0,"span"),t._uU(1,"El taller es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function D(a,i){if(1&a&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.nombre," ")}}function J(a,i){1&a&&(t.TgZ(0,"span"),t._uU(1,"El taller es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}let O=(()=>{class a{constructor(e){this.data=e,this.fb=(0,t.f3M)(p.qu),this.dialogRef=(0,t.f3M)(c.so),this.datePipe=(0,t.f3M)(d.uU),this._apiService=(0,t.f3M)(g.sM),this._capitan="",this._niveles=[],console.log("datos que llegan",e),this._capitan=e.info?.tropa.nombres+" "+e.info?.tropa.apellidos,this._objInfo=e.info?.idcapitan,this._niveles=e.info?.niveles}ngOnInit(){this.initializeValidations(),this.form.controls.capitan.disable()}initializeValidations(){this.form=this.fb.nonNullable.group({fecha:[null,p.kI.required],capitan:[null],idtaller:[null,[p.kI.required]],niveles:[null]}),this.form.setValue({fecha:null,capitan:this._capitan,idtaller:null,niveles:this._niveles})}addTaller(){if(this.form.invalid)return;let e={fecha:this.datePipe.transform(this.form.value.fecha,"MM/dd/yyyy"),idcapitan:this._objInfo,idtaller:this.form.value.idtaller,socializado:0};this.dialogRef.close({data:e})}getTalleres(){this._apiService.getTalleres(this.form.value.niveles).subscribe({next:e=>{this._nombreTaller=e,this.form.controls.idtaller.setValue(null)},error:e=>{console.log("Error",e)}})}cancelar(){this.dialogRef.close({action:"cancel"})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.WI,8))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-modal-taller"]],standalone:!0,features:[t.jDz],decls:43,vars:8,consts:[["mat-dialog-title","",1,"text-center"],[3,"formGroup","ngSubmit"],[1,"mat-typography"],[1,"row"],[1,"col-5"],["appearance","fill"],["formControlName","fecha","matInput","",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],[1,"error"],[4,"ngIf"],[1,"col-4"],["formControlName","capitan","matInput","","autocomplete","off",1,"fw-bold"],[1,"col-3"],["formControlName","niveles",3,"selectionChange"],["select",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12"],["formControlName","idtaller"],["align","end",1,"mx-3"],[1,"mx-4"],["type","button","mat-button","","color","warn",1,"m-btncancel",3,"click"],["type","submit","mat-button","","cdkFocusInitial","","color","primary",1,"m-btnaceptar"],[3,"value"]],template:function(e,n){if(1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Agregar Taller X Capitan"),t.qZA(),t.TgZ(2,"form",1),t.NdJ("ngSubmit",function(){return n.addTaller()}),t.TgZ(3,"mat-dialog-content",2)(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),t._uU(8,"Fecha Socializaci\xf3n"),t.qZA(),t._UZ(9,"input",6)(10,"mat-datepicker-toggle",7)(11,"mat-datepicker",null,8),t.qZA(),t.TgZ(13,"div",9),t.YNc(14,y,4,0,"span",10),t.qZA()(),t.TgZ(15,"div",11)(16,"mat-form-field",5)(17,"mat-label"),t._uU(18,"Nombre Capitan"),t.qZA(),t._UZ(19,"input",12),t.qZA()(),t.TgZ(20,"div",13)(21,"mat-form-field",5)(22,"mat-label"),t._uU(23,"Niveles"),t.qZA(),t.TgZ(24,"mat-select",14,15),t.NdJ("selectionChange",function(){return n.getTalleres()}),t.YNc(26,k,2,2,"mat-option",16),t.qZA()(),t.TgZ(27,"div",9),t.YNc(28,q,4,0,"span",10),t.qZA()(),t.TgZ(29,"div",17)(30,"mat-form-field",5)(31,"mat-label"),t._uU(32,"Nombre del taller"),t.qZA(),t.TgZ(33,"mat-select",18),t.YNc(34,D,2,2,"mat-option",16),t.qZA()(),t.TgZ(35,"div",9),t.YNc(36,J,4,0,"span",10),t.qZA()()()(),t.TgZ(37,"mat-dialog-actions",19)(38,"span",20)(39,"button",21),t.NdJ("click",function(){return n.cancelar()}),t._uU(40," Cancelar "),t.qZA()(),t.TgZ(41,"button",22),t._uU(42," Aceptar "),t.qZA()()()),2&e){const l=t.MAs(12);let r,m,_;t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("matDatepicker",l),t.xp6(1),t.Q6J("for",l),t.xp6(4),t.Q6J("ngIf",(null==(r=n.form.get("fecha"))?null:r.hasError("required"))&&(null==(r=n.form.get("fecha"))?null:r.touched)),t.xp6(12),t.Q6J("ngForOf",n._niveles),t.xp6(2),t.Q6J("ngIf",(null==(m=n.form.get("niveles"))?null:m.hasError("required"))&&(null==(m=n.form.get("niveles"))?null:m.touched)),t.xp6(6),t.Q6J("ngForOf",n._nombreTaller),t.xp6(2),t.Q6J("ngIf",(null==(_=n.form.get("idtaller"))?null:_.hasError("required"))&&(null==(_=n.form.get("idtaller"))?null:_.touched))}},dependencies:[d.ez,d.sg,d.O5,c.Is,c.uh,c.xY,c.H8,u.ot,u.lW,v.c,v.Nt,f.KE,f.hX,f.R9,x.LD,x.gD,z.ey,h.FA,h.Mq,h.hl,h.nW,p.u5,p._Y,p.Fj,p.JJ,p.JL,p.UX,p.sg,p.u],styles:[".mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;margin-right:10px}.error[_ngcontent-%COMP%]{color:#f44336;margin-top:-10px;font-size:14px}.m-buttons[_ngcontent-%COMP%]{margin:10px}"]}),a})();var Y=o(9299);let E=(()=>{class a{constructor(e,n){this.dialogRef=e,this.data=n,this.actionProcess="",this._name="",this._name=n.info?.nombre,console.log("dato a elinar",n)}deletePerson(){this.dialogRef.close({action:this.actionProcess,idtaller:this.data.info?.id,idcapitan:this.data.info?.idcapitan})}cancelar(){this.dialogRef.close({action:"cancel"})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.so),t.Y36(c.WI,8))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-alert-msg"]],standalone:!0,features:[t.jDz],decls:14,vars:1,consts:[["mat-dialog-title","",1,"text-center","bg-secondary","bg-opacity-10"],["mat-dialog-content","",1,"text-center","container"],[1,"text-danger"],["mat-dialog-actions",""],[1,"float-end","mt-4"],["mat-stroked-button","","mat-dialog-close","",1,"m-btncanel",3,"click"],["mat-stroked-button","","cdkFocusInitial","","color","warn",1,"m-btnaceptar",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"h2",0),t._uU(1," Eliminaci\xf3n registro\n"),t.qZA(),t.TgZ(2,"div",1),t._uU(3," Desea eliminar a: "),t._UZ(4,"br"),t.TgZ(5,"span",2),t._uU(6),t.qZA(),t._uU(7,"?\n"),t.qZA(),t.TgZ(8,"div",3)(9,"div",4)(10,"button",5),t.NdJ("click",function(){return n.cancelar()}),t._uU(11," Cancel "),t.qZA(),t.TgZ(12,"button",6),t.NdJ("click",function(){return n.deletePerson()}),t._uU(13," Si "),t.qZA()()()),2&e&&(t.xp6(6),t.Oqu(n._name))},dependencies:[d.ez,u.ot,u.lW],styles:[".m-btnaceptar[_ngcontent-%COMP%], .m-btncanel[_ngcontent-%COMP%]{margin:0 15px}"]}),a})();function I(a,i){1&a&&(t.TgZ(0,"th",19),t._uU(1,"Fecha"),t.qZA())}function Q(a,i){if(1&a&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.hij(" ",e.fecha," ")}}function P(a,i){1&a&&(t.TgZ(0,"th",19),t._uU(1," Nombre "),t.qZA())}function R(a,i){if(1&a&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.AsE(" ",e.nombres," ",e.apellidos," ")}}function j(a,i){1&a&&(t.TgZ(0,"th",19),t._uU(1," Taller "),t.qZA())}function F(a,i){if(1&a&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.hij(" ",e.nombretaller," ")}}function w(a,i){1&a&&(t.TgZ(0,"th",19),t._uU(1,"Nivel"),t.qZA())}function B(a,i){if(1&a&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.hij(" ",e.idnivel," ")}}function H(a,i){1&a&&(t.TgZ(0,"th",19),t._uU(1," Socializado "),t.qZA())}function X(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"span")(1,"button",22),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit,r=t.oxw();return t.KtG(r.updateTallerSocializado(l))}),t.TgZ(2,"mat-icon",23),t._uU(3,"done_all"),t.qZA()()()}}function $(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"span")(1,"button",22),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit,r=t.oxw();return t.KtG(r.updateTallerSocializado(l))}),t.TgZ(2,"mat-icon",24),t._uU(3,"remove_done"),t.qZA()()()}}function G(a,i){if(1&a&&(t.TgZ(0,"td",20),t.YNc(1,X,4,0,"span",21),t.YNc(2,$,4,0,"span",21),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.Q6J("ngIf",1===e.socializado),t.xp6(1),t.Q6J("ngIf",0===e.socializado)}}function L(a,i){1&a&&t._UZ(0,"th",19)}function W(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"td",20)(1,"button",22),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.deleteTallerSocializado(r))}),t.TgZ(2,"mat-icon",25),t._uU(3,"delete_forever"),t.qZA()()()}}function V(a,i){1&a&&t._UZ(0,"tr",26)}function K(a,i){1&a&&t._UZ(0,"tr",27)}const tt=function(){return[10,20,50,100]};let et=(()=>{class a{constructor(){this.dialog=(0,t.f3M)(c.uw),this.dialog_msg=(0,t.f3M)(c.uw),this._snackbarService=(0,t.f3M)(g.o),this._dataService=(0,t.f3M)(g.gh),this._apiService=(0,t.f3M)(g.sM),this._talleres=[],this._nieles=[],this.objTropa={},this.loading=!1,this.horizontalPosition="start",this.verticalPosition="bottom",this.displayedColumns=["fecha","nombres","nombretaller","nivel","socializado","delete"],this.dataSource=new s.by}ngOnInit(){this.data$=this._dataService.sharingObservable,this._subcriptionList=this._dataService.sharingObservable.subscribe(e=>{this.objTropa=e?.datoTropa,this._idcapitan=e?.datoTropa.idCapitan,this.getTalleresSocializados(this._idcapitan)})}getTalleresSocializados(e){this._apiService.getTalleresXCapitan(e).subscribe({next:n=>{n.length>0?(this.dataSource.data=n,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort):this.dataSource.data=[]},complete:()=>{this.getNivelesCapitan(this._idcapitan)},error:n=>{console.log("Error",n)}})}getNivelesCapitan(e){this._apiService.getNivelesXCapitan(e).subscribe({next:n=>{this._nieles=n,this.objTaller=Object.assign({niveles:this._nieles,tropa:this.objTropa,idcapitan:this._idcapitan})},error:n=>{console.log("Error",n)}})}addSeguimiento(){this.dialog.open(O,{data:{info:this.objTaller},width:"650px",disableClose:!0}).afterClosed().subscribe(n=>{"cancel"!==n.action&&(this.addTallerSocializado(n.data),this.getTalleresSocializados(this._idcapitan))})}addTallerSocializado(e){this._apiService.addTallerSocializado(e).subscribe({next:n=>{"El registro ya existe!."===n.msg?this._snackbarService.openSnackBar(n.msg,"yellow"):(this._snackbarService.openSnackBar(n.msg,"green"),this.getTalleresSocializados(this._idcapitan))},error:n=>{console.log("Error",n),this._snackbarService.openSnackBar(n.msg,"red")}})}updateTallerSocializado(e){let n;n=0===e.socializado?{id:e.id,fecha:e.fecha,idcapitan:e.idcapitan,idtaller:e.idtaller,socializado:1}:{id:e.id,fecha:e.fecha,idcapitan:e.idcapitan,idtaller:e.idtaller,socializado:0},this._apiService.updateTallerCapitan(e.id,n).subscribe({next:l=>{this._snackbarService.openSnackBar(l.msg,"green"),this.getTalleresSocializados(this._idcapitan)},error:l=>{console.log("Error",l)}})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.paginator._intl.itemsPerPageLabel="Items por p\xe1gina"}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}deleteTallerSocializado(e){this.dialog_msg.open(E,{data:{action:"delete",info:{id:e.id,nombre:e.nombretaller,idcapitan:this._idcapitan}},width:"300px",minHeight:"160px",disableClose:!0}).afterClosed().subscribe(r=>{"cancel"!==r.action&&(console.log("Dato a eliminar",r),this._apiService.deleteTallerCapitan(r.idtaller,r.idcapitan).subscribe({next:m=>{console.log("RESPUESTA ELIMINACION",m),this._snackbarService.openSnackBar(m.msg,"green"),this.getTalleresSocializados(this._idcapitan)},error:m=>{console.log("Error",m),this._snackbarService.openSnackBar("Registro no eliminado!.","red")}}))})}ngOnDestroy(){this._subcriptionList&&this._subcriptionList.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-list-personas"]],viewQuery:function(e,n){if(1&e&&(t.Gf(C.NW,5),t.Gf(b.YE,5)),2&e){let l;t.iGM(l=t.CRH())&&(n.paginator=l.first),t.iGM(l=t.CRH())&&(n.sort=l.first)}},standalone:!0,features:[t.jDz],decls:32,vars:5,consts:[[1,"mt-4"],[1,"text-center"],[1,"mat-elevation-z8"],[1,"row"],[1,"col"],["mat-raised-button","","color","primary",1,"float-end",3,"click"],[1,"scroll-container"],["mat-table","","matSort","",1,"table-sm",3,"dataSource"],["matColumnDef","fecha","sticky",""],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","nombres"],["matColumnDef","nombretaller"],["matColumnDef","nivel"],["matColumnDef","socializado"],["matColumnDef","delete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-header-cell","",1,"text-center"],["mat-cell","",1,"text-center"],[4,"ngIf"],["mat-icon-button","",3,"click"],[1,"text-success"],[1,"text-danger"],["color","warn"],["mat-header-row",""],["mat-row",""]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Listado de Talleres por Capitan"),t.qZA(),t.TgZ(3,"mat-card")(4,"mat-card-content",2)(5,"div",3)(6,"div",4)(7,"button",5),t.NdJ("click",function(){return n.addSeguimiento()}),t._uU(8," Agregar "),t.qZA()()(),t.TgZ(9,"div",6)(10,"table",7),t.ynx(11,8),t.YNc(12,I,2,0,"th",9),t.YNc(13,Q,2,1,"td",10),t.BQk(),t.ynx(14,11),t.YNc(15,P,2,0,"th",9),t.YNc(16,R,2,2,"td",10),t.BQk(),t.ynx(17,12),t.YNc(18,j,2,0,"th",9),t.YNc(19,F,2,1,"td",10),t.BQk(),t.ynx(20,13),t.YNc(21,w,2,0,"th",9),t.YNc(22,B,2,1,"td",10),t.BQk(),t.ynx(23,14),t.YNc(24,H,2,0,"th",9),t.YNc(25,G,3,2,"td",10),t.BQk(),t.ynx(26,15),t.YNc(27,L,1,0,"th",9),t.YNc(28,W,4,0,"td",10),t.BQk(),t.YNc(29,V,1,0,"tr",16),t.YNc(30,K,1,0,"tr",17),t.qZA(),t._UZ(31,"mat-paginator",18),t.qZA()()()()),2&e&&(t.xp6(10),t.Q6J("dataSource",n.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(4,tt)))},dependencies:[d.ez,d.O5,A.q,T.a8,T.dn,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,C.NW,b.YE,S.Hw,u.lW,u.RK,T.QW,s.p0,C.TU,b.JX,f.lN,v.c,S.Ps,M.AV,u.ot,c.Is,N.Cv,U.ZX,Y.Bz],styles:["table[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:90%;margin-right:10px}.btnEdit[_ngcontent-%COMP%], .btnDelete[_ngcontent-%COMP%]{cursor:pointer}.btnDelete[_ngcontent-%COMP%]{color:#b0304b}.btnEdit[_ngcontent-%COMP%]{color:#4b7bcd}.scroll-container[_ngcontent-%COMP%]{overflow:auto;background:#fff}"]}),a})()}}]);