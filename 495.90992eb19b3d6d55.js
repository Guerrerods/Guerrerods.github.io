"use strict";(self.webpackChunkEscuelaDS=self.webpackChunkEscuelaDS||[]).push([[495],{8495:(W,u,l)=>{l.r(u),l.d(u,{AutorizacionTallerComponent:()=>Q});var t=l(4650),s=l(6895),m=l(3999),c=l(4006),v=l(9299),r=l(7155),T=l(4514),h=l(6308),p=l(8739),d=l(3546),g=l(9549),C=l(7392),f=l(4859),A=l(5412),E=l(4385),z=l(3238);function D(a,i){if(1&a&&(t.TgZ(0,"mat-option",27),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.AsE(" ",null==e?null:e.nombres," ",null==e?null:e.apellidos," ")}}function Z(a,i){1&a&&(t.TgZ(0,"span"),t._uU(1,"El capit\xe1n es "),t.TgZ(2,"strong"),t._uU(3,"requerida"),t.qZA()())}function M(a,i){if(1&a&&(t.TgZ(0,"mat-option",27),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",null==e?null:e.descripcion," ")}}function O(a,i){1&a&&(t.TgZ(0,"span"),t._uU(1,"El capit\xe1n es "),t.TgZ(2,"strong"),t._uU(3,"requerida"),t.qZA()())}function x(a,i){1&a&&(t.TgZ(0,"th",28),t._uU(1,"Nivel"),t.qZA())}function P(a,i){if(1&a&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.hij(" ",e.descripcion," ")}}function U(a,i){1&a&&(t.TgZ(0,"th",28),t._uU(1," Autorizado "),t.qZA())}const N=function(a,i){return{"text-success":a,"text-danger":i}};function L(a,i){if(1&a&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.Q6J("ngClass",t.WLB(2,N,1===e.autorizado,0===e.autorizado)),t.xp6(1),t.hij(" ",1===e.autorizado?"Si":"No"," ")}}function b(a,i){1&a&&t._UZ(0,"th",31)}function S(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"span")(1,"button",33),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,_=t.oxw();return t.KtG(_.authorizedLevel(o))}),t.TgZ(2,"mat-icon"),t._uU(3,"lock_person"),t.qZA()()()}}function B(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"span")(1,"button",34),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,_=t.oxw();return t.KtG(_.authorizedLevel(o))}),t.TgZ(2,"mat-icon"),t._uU(3,"lock_open"),t.qZA()()()}}function I(a,i){if(1&a&&(t.TgZ(0,"td",32),t.YNc(1,S,4,0,"span",9),t.YNc(2,B,4,0,"span",9),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.Q6J("ngIf",0===e.autorizado),t.xp6(1),t.Q6J("ngIf",1===e.autorizado)}}function R(a,i){1&a&&t._UZ(0,"tr",35)}function J(a,i){1&a&&t._UZ(0,"tr",36)}const K=function(){return[10,20,50,100]};let Q=(()=>{class a{constructor(){this._snackbarService=(0,t.f3M)(m.o),this._apiService=(0,t.f3M)(m.sM),this.fb=(0,t.f3M)(c.qu),this._niveles=[],this._capitanes=[],this.displayedColumns=["descripcion","autorizado","autoriza"],this.dataSource=new r.by}ngOnInit(){this.initializeValidations(),this.getNiveles()}initializeValidations(){this.form=this.fb.nonNullable.group({idcapitan:[null,c.kI.required],idnivel:[null,c.kI.required]})}authorizationLevel(){this.form.invalid||this._apiService.addNivelCapitan({idcapitan:this.form.value.idcapitan,idnivel:this.form.value.idnivel,autorizado:0}).subscribe({next:n=>{this._snackbarService.openSnackBar(n.msg,"green"),this.getNivelesCapitan()},error:n=>{console.log("Error",n)}})}getNiveles(){this._apiService.getNiveles().subscribe({next:e=>{this._niveles=e},complete:()=>{this.getCapitanes()},error:e=>{console.log("Error",e)}})}getAllLevels(e){this._apiService.getLevelAuthorization(e).subscribe({next:n=>{this.dataSource.data=n,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort},error:n=>{console.log("Error",n)}})}getNivelesCapitan(){this.getAllLevels(this.form.value.idcapitan)}getCapitanes(){this._apiService.getCapitanes().subscribe({next:e=>{this._capitanes=e},error:e=>{console.log("Error",e)}})}authorizedLevel(e){console.log("element",e),this.updateAuthorizedLevel(e.id,1===e.autorizado?{idcapitan:this.form.value.idcapitan,idnivel:e.idnivel,autorizado:0}:{idcapitan:this.form.value.idcapitan,idnivel:e.idnivel,autorizado:1})}updateAuthorizedLevel(e,n){this._apiService.updateAutorizedLevelCapitan(e,n).subscribe({next:o=>{this._snackbarService.openSnackBar(o.msg,"green"),this.getNivelesCapitan()},error:o=>{console.log("Error",o)}})}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-autorizacion-taller"]],viewQuery:function(e,n){if(1&e&&(t.Gf(p.NW,5),t.Gf(h.YE,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.paginator=o.first),t.iGM(o=t.CRH())&&(n.sort=o.first)}},standalone:!0,features:[t.jDz],decls:40,vars:10,consts:[["mat-dialog-title","",1,"text-center","mt-4"],[1,"container"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-6"],["appearance","fill"],["formControlName","idcapitan",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"error"],[4,"ngIf"],[1,"col-4"],["formControlName","idnivel"],[1,"col-2","my-3"],["mat-raised-button","","color","primary"],[1,"mat-elevation-z8"],["mat-table","",1,"table-sm",3,"dataSource"],["matColumnDef","descripcion"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","autorizado"],["mat-cell","","class","text-center",3,"ngClass",4,"matCellDef"],["matColumnDef","autoriza"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of users",3,"pageSizeOptions"],[3,"value"],["mat-header-cell","",1,"text-center"],["mat-cell","",1,"text-center"],["mat-cell","",1,"text-center",3,"ngClass"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",1,"text-danger",3,"click"],["mat-icon-button","",1,"text-success",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,n){if(1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Atorizaci\xf3n nivel por Capitan"),t.qZA(),t.TgZ(2,"div",1)(3,"form",2),t.NdJ("ngSubmit",function(){return n.authorizationLevel()}),t.TgZ(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),t._uU(8,"Capitanes"),t.qZA(),t.TgZ(9,"mat-select",6),t.NdJ("selectionChange",function(){return n.getNivelesCapitan()}),t.YNc(10,D,2,3,"mat-option",7),t.qZA()(),t.TgZ(11,"div",8),t.YNc(12,Z,4,0,"span",9),t.qZA()(),t.TgZ(13,"div",10)(14,"mat-form-field",5)(15,"mat-label"),t._uU(16,"Niveles"),t.qZA(),t.TgZ(17,"mat-select",11),t.YNc(18,M,2,2,"mat-option",7),t.qZA()(),t.TgZ(19,"div",8),t.YNc(20,O,4,0,"span",9),t.qZA()(),t.TgZ(21,"div",12)(22,"button",13),t._uU(23,"Agregar"),t.qZA()()()()(),t.TgZ(24,"mat-card",14)(25,"div",1)(26,"mat-card-content")(27,"table",15),t.ynx(28,16),t.YNc(29,x,2,0,"th",17),t.YNc(30,P,2,1,"td",18),t.BQk(),t.ynx(31,19),t.YNc(32,U,2,0,"th",17),t.YNc(33,L,2,5,"td",20),t.BQk(),t.ynx(34,21),t.YNc(35,b,1,0,"th",22),t.YNc(36,I,3,2,"td",23),t.BQk(),t.YNc(37,R,1,0,"tr",24),t.YNc(38,J,1,0,"tr",25),t.qZA(),t._UZ(39,"mat-paginator",26),t.qZA()()()),2&e){let o,_;t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("ngForOf",n._capitanes),t.xp6(2),t.Q6J("ngIf",(null==(o=n.form.get("idcapitan"))?null:o.hasError("required"))&&(null==(o=n.form.get("idcapitan"))?null:o.touched)),t.xp6(6),t.Q6J("ngForOf",n._niveles),t.xp6(2),t.Q6J("ngIf",(null==(_=n.form.get("idnivel"))?null:_.hasError("required"))&&(null==(_=n.form.get("idnivel"))?null:_.touched)),t.xp6(7),t.Q6J("dataSource",n.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(9,K))}},dependencies:[s.ez,s.mk,s.sg,s.O5,T.q,d.a8,d.dn,r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,p.NW,g.KE,g.hX,C.Hw,f.lW,f.RK,A.uh,E.gD,z.ey,c.u5,c._Y,c.JJ,c.JL,c.UX,c.sg,c.u,v.Bz],styles:[".mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;margin-right:10px}.error[_ngcontent-%COMP%]{color:#f44336;margin-top:-10px;font-size:14px}.mat-mdc-table[_ngcontent-%COMP%]   .mdc-data-table__row[_ngcontent-%COMP%]{height:40px}.mat-mdc-header-cell[_ngcontent-%COMP%]{background-color:#f9f8f7!important}"]}),a})()}}]);